# 2.6. 創建和驗證新的區塊

TON 區塊鏈最終由分片鏈和主鏈區塊組成。為了保障系統平穩運行，這些區塊必須通過網路來創建、驗證並其傳播給所有相關方。

### 2.6.1	驗證人（Validator）

新區塊由特殊的指定節點（稱為驗證人）創建和驗證。基本上，任何希望成為驗證人的節點都可以成為一個驗證人，只要它能夠將足夠大量的質押資產（在 TON 代幣中，即 Grams；參見附錄 A）存入主鏈。 驗證人因其出色的工作而獲得了一些 “獎勵”，也就是說，所有來自交易（消息）、存儲和 gas的費用都被投入到新生成的區塊和一些新鑄造的幣中，這反映了整個社區對保證 TON Blockchain 平穩運作的的驗證人的“感激（gratitude）”該收入按比例分配給所有參與的驗證人。

然而，作為驗證人是一項高度責任。如果驗證人簽署了無效區塊，則會迎來通過丟失部分或全部質押資產的處罰，並暫時或永久地從驗證人集合中排除。如果驗證人不參與創建區塊，則不會收到與該區塊相關的獎勵份額。如果驗證人長期放棄創建新區塊，它可能會丟失部分質押資產，並被暫停或永久排除在驗證人集合之外。

所有這一切都意味著驗證人不會 “什麼都不做” 就賺到錢。實際上，它必須追蹤所有或一些分片鏈的狀態（每個驗證人負責驗證和創建分片鏈某個子集中的新區塊），執行這些分片鏈中智慧合約請求的所有計算，接收有關其他的更新分片鏈等。該活動需要相當大的存儲空間、算力和網路頻寬。

### 2.6.2	驗證人（Validator）代替礦工（Miner）

回想一下，TON區塊鏈使用的是共識演算法是 POS，而不是POW這種被當前版本的乙太坊以及大多數其他加密貨幣採用的工作量證明方法。這意味著人們不能通過提供一些證明工作（計算許多其他無用的雜湊）來 “挖（mine）” 一個新的區塊，並因此獲得一些新的幣。相反，人們必須成為驗證人，並花費計算資源來存儲和處理 TON 區塊鏈的請求和資料。簡而言之，某人如果想要開採新的代幣，則必須成為驗證人。這樣一來，驗證人就是新的礦工。

然而，除了成為驗證人外，還有其他一些方法來賺幣。

### 2.6.3	提名人（Nominator）和 “mining pools（礦池）”

要成為驗證人，需要購買並安裝多個高性能伺服器並需要維持良好穩定網路連接。這並不像目前開發比特幣所需的 ASIC 設備那麼昂貴。然而，絕對不能在家用電腦上挖掘新的 TON代幣，更別提智能手機了。

在比特幣，乙太坊和其他工作量證明加密貨幣挖掘社區中，有一個挖掘池的概念，挖掘池其中許多節點個體不具由挖掘新區塊的計算能力，但他們團結在一起努力並在之後分享獎勵。

這對應在權益證明世界中的相應概念則提名人。從本質上講，這是一個節點借錢來幫助驗證人增加其抵押物；驗證人然後將其獎勵的相應份額（或之前商定的一部分——比如 50％）分配給提名人。

通過這種方式，提名人也可以參與 “挖礦（mining）” 並獲得與其願意為此目的存入的金額成比例的一些獎勵。它僅獲得驗證人獎勵的相應份額的一小部分，因為它僅提供 “資本（capital）”，但不需要購買計算能力，存儲和網路頻寬。

但是，如果驗證人因無效行為而失去其抵押物，則提名人也會失去其抵押物。從這個意義上說，提名人分擔風險。它必須明智地選擇其指定的驗證人，否則可能會賠錢。從這個意義上說， 提名人做出加權決定，並用他們的資金對某些驗證人進行 “投票（vote）”。

另一方面，這個提名或借出系統使人們能夠成為驗證人，而無需先向 Grams（TON 幣）投入大量資金。換句話說，它可以阻止那些使用大量的 Grams 壟斷驗證人的人。

### 2.6.4	漁夫（Fisherman）：通過指出別人的錯誤來獲得金錢

獲得一些獎勵而不是驗證人的另一種方法是成為一名漁夫。基本上，任何節點都可以通過在主鏈中存入少量存款而成為漁夫。然後，它可以使用特殊的主鏈交易來發佈先前由驗證人簽名和發佈的一些（通常是分片鏈）區塊的（Merkle）無效證明。如果其他驗證人同意該無效證明， 則違規驗證人將被處罰（通過丟失部分質押資產），並且漁夫獲得一些獎勵（從違規驗證人處沒收的一小部分幣）。之後，必須按照 2.1.17 中的描述更正無效（分片鏈）塊。糾正無效的主鏈區塊可能涉及在先前提交的主鏈區塊之上創建 “垂直” 塊（參見 2.1.17）；沒有必要創建主鏈的分支。

通常，漁夫需要成為至少一些分片鏈的完整節點，並通過運行至少一些智慧合約的代碼來花費一些計算資源。雖然漁夫不需要具有作為驗證人的計算能力，但我們認為成為漁夫的自然候選人是準備處理新區塊的潛在驗證人，但尚未被選為驗證人（例如，由於未能存放足夠大的抵 押）。

### 2.6.5	校對人（Collator）：通過給驗證人提供出新區塊的建議來獲得金錢

另一種獲得一些獎勵而不是驗證人的方法是成為一名校對人。這是一個節點，它準備並向驗證人建議新的分片鏈候選區塊，補充（校對）從該分片鏈的狀態和其他（通常是鄰近的）分片鏈獲取的資料，以及合適的 Merkle 證明。（這是必要的。例如，當某些消息需要從相鄰的分片鏈轉發時。）然後驗證人可以輕鬆地檢查建議的候選區塊的有效性，而無需下載此或其他分片鏈的完整狀態。
因為驗證人需要提交新的（校對後的）候選區塊以獲得一些（“挖礦”）獎勵，所以將一部分獎勵支付給願意提供合適的候選區塊的校對人是有意義的。通過這種方式，驗證人可以通過將其外包給校對人來擺脫觀察相鄰分片鏈狀態的必要性。

但是，我們希望在系統的初始部署階段不會有單獨的指定校對人，因為所有驗證人都可以自己充當校對人。

### 2.6.6	校對人或驗證人：從説明使用者整合交易中獲取金錢

用戶可以向一些校對人或驗證人打開小額支付通道，並支付少量幣以換取在分片鏈中包含他們的交易的權利。

### 2.6.7	選舉全域驗證人

每個月選出一組 “全域（global）” 驗證人（主鏈每出 $2^{19}$ 個塊選舉一次）。這個設置普遍會被提前一個月確定並被廣泛宣告。

為了成為驗證人，節點必須將一些TON幣（Grams）轉移到主鏈中，然後將它們作為預備的質押資產$s$發送至一個特殊的智慧合約。與質押資產一起發送的另一個參數是 $l ≥1$，與可能的最小值比起來，這是該節點願意接受的最大驗證負載。l 還有一個全域上限（另一個可配置參數）參數 L，當 $L=10$ 時，我們把 l 稱為 L。

然後通過這個智慧合約選擇全域驗證人，簡單地通過最大建議質押選擇最多 T 個候選人並公佈它們的身份。最初，驗證人的總數是 $T=100$；我們預計隨著負載的增加它可能增長到$1000$。$T$是一個可配置參數（參見 2.1.21）。

每個驗證人的實際質押資產計算如下：如果最高的T建議的抵押物是 $s_1 ≥ s_2 ≥···≥ s_T$，第i個驗證人的實際賭注設置為$s’_i：= min (s_i, l_i·s_T)$。通過這種方式，$s’_i / s’_T ≤ l_i$，因此第i個驗證人獲得的負載不超過最弱驗證人的li≤L倍（因為負載最終與抵押物成比例）。

然後當選的驗證人可以撤回質押資產中未使用的部分，即$s_i-s’_i$。未能成功獲選的驗證人候選人可以撤回它們提出的所有建議質押資產。

每個驗證人都發佈其公共簽名金鑰，不一定等於質押資產來源的帳戶的公開金鑰。21

驗證人的質押資產被凍結，直到它們當選的期限結束，或者還有一個月的額外時間，以防出現新的糾紛（即，找到由這些驗證人其中之一簽名的無效塊）。在此之後，將返還質押資產，以及驗證人的鑄幣份額及在此期間處理的交易費用。

### 2.6.8	“任務組（task groups）”。

全域驗證人（其中每個驗證人被認為擁有的資產遠遠多於質押資產——否則驗證人可能傾向於偽造幾個身份並將自己的質押資產分發給每一個假身份）僅用於驗證新的主鏈區塊。分片鏈區塊僅通過特別選擇的驗證人子集進行驗證，這些驗證人子集取自 2.6.7 中所述選擇的全域驗證人集。
為每個分片定義的這些驗證人 “子集” 或 “任務組” 每小時輪換一次（實際上，每 210 個主鏈區塊輪換一次），並且它們會提前一小時知道，這樣每個驗證人都知道驗證需要哪些分片，並且可以為此做好準備（例如，通過下載丟失的分片鏈資料）。

用於為每個分片$（w,s）$選擇驗證人任務組的演算法是確定性偽隨機。它使用驗證人嵌入的偽亂數到每個主鏈區塊（由使用閾值簽名的共識生成）來創建隨機種子，然後計算為每個驗證人計算 雜湊，例如（code(w).code(s).validatorid.randseed）。然後驗證人按該雜湊的值進行排序，並選擇前幾個驗證人，以便至少具有驗證人總質押資產的 $20 / T$，並且至少包含 5 個驗證人。

這種選擇可以通過特殊的智慧合約來完成。在這種情況下，選擇演算法很容易升級，而不需要
2.1.21 中提到的投票機制的硬分叉。到目前為止提到的所有其他 “常量（constants）” （例如219, 210, T, 20, 和 5）也是可配置參數。

### 2.6.9	在每個任務組上輪換優先順序順序。

根據先前主鏈區塊和（分片鏈）區塊序號的雜湊，  對於分片任務組的成員而言具有一定的“優先順序（priority）” 順序。如上所述，該順序通過生成和排序某些雜湊來確定。

---

21 在每個驗證人選舉的過程中，生成和使用金鑰對是有意義的。

---

當需要生成新的分片鏈區塊時，選擇創建該區塊的分片任務組驗證人通常是關於該輪換 “優先順序” 順序中的第一個。如果它無法創建區塊，則第二個或第三個驗證人可以執行該操作。從本質上講，它們都可以推薦它們的候選區塊，但具有最高優先順序的驗證人建議的候選區塊應該作為拜占庭容錯（BFT，Byzantine Fault Tolerant）共識協議的結果而獲勝。

### 2.6.10	分片鏈候選區塊的傳播。

由於分片鏈任務組成員資格是提前一小時知道的，因此使用 TON網路的一般機制（參見 3.3），其成員可以利用該時間構建專用的 “分片驗證人多播覆蓋網路（shard validators multicast overlay network）”。當需要生成新的分片鏈區塊時——通常在最近的主鏈區塊傳播後一兩秒鐘——每個人都知道誰具有最高優先順序來生成下一個區塊（參見 2.6.9）。該驗證人將自行或者在校對人的幫助下創建一個新的校對過的候選區塊，（參見 2.6.5）。驗證人必須檢查（驗證）該候選區塊（特別是如果它已由某個校對人準備）並使用其（驗證人）私密金鑰對其進行簽 名。然後使用預先安排的多播覆蓋網路將候選區塊傳播到任務組的其餘部分（任務組創建其自己的專用覆蓋網路，如 3.3 中所述，然後使用 3.3.15 中描述的流式多播協議的版本來傳播候選區塊）。

真正的 BFT 方式是使用一個拜占庭組播協議（Byzantine multicast
protocol），例如 Honey Badger BFT 中使用的協定：用$（N, 2N / 3）$——擦除碼來編碼候選區塊，直接發送 $1 / N$ 結果資料給組裡的每個成員，並期望它們將其部分資料直接組播到組的所有其他成員。

然而，更快更直接的方法（參見 3.3.15）是將候選區塊分成一系列有符號的一千位元組塊（“塊(chunks)”），用 Reed-Solomon 或者一個噴泉碼（例如 RaptorQ 代碼）來增加它們的序列， 並開始向 “組播網格（multicast mesh）”（即覆蓋網路）中的鄰近節點發送區塊，期望它們進一步傳播這些區塊。一旦驗證人獲得足夠的塊以從它們重建候選區塊，它就簽署確認收據並通過其鄰近節點將其傳播到整個組。然後它的鄰近節點停止向它發送新的區塊，但是可以繼續發送這些區塊的（原始）簽名，相信該節點可以通過自己應用 Reed-Solomon 或 噴泉碼（具有所有必要的資料）來生成後續區塊，並將它們與簽名結合起來傳播給尚未準備好的相鄰區塊。如果在刪除所有 “壞” 節點後 “組播網格（multicast mesh）”（覆蓋網路）仍保持連接（回想一下，以拜占庭方式允許多達三分之一的節點是壞的，即以任意惡意方式行事），該演算法將盡可能快地傳播候選區塊。

不僅指定的高優先順序區塊創建者可以將其候選區塊組播到整個組。優先順序第二和第三的驗證人可以立即或在未能從最高優先順序驗證人接收候選區塊之後開始組播它們的候選區塊。但是，通常只有具有最大優先順序的候選區塊將由所有（實際上，至少為任務組的三分之二）驗證人簽名並作為新的分片鏈區塊提交。

### 2.6.11	驗證候選區塊。

一旦驗證人接收到候選區塊並且檢查了其原始驗證人的簽名，則接收驗證人通過執行其中的所有交易並檢查它們的結果是否與所聲明的一致來檢查該候選區塊的有效性。從其他區塊鏈導入的所有消息必須由校對資料中的合適 Merkle 證明支援，否則候選區塊被視為無效（並且，如果將此證明提交給主鏈，則驗證人已經簽署了此候選區塊則可能會受到懲罰）。另一方面，如果發現候選區塊有效，則接收驗證人對其進行簽名，並通過 “組播網狀網路 （multicast mesh network）” 或直接網路消息將其簽名傳播到該組中的其他驗證人。

我們想強調一個驗證人不需要訪問這個或相鄰的分片鏈的狀態，以便檢查（校對的）候選區塊的有效性。22這允許驗證非常快速地進行（沒有磁片訪問），並且減輕驗證人的計算和存儲負擔（特別是如果它們願意接受外部校對人的服務來創建候選區塊者）。

### 2.6.12	選舉下一個候選區塊。

一旦候選區塊（通過質押）收集任務組中驗證人至少三分之二的有效性簽名，它就有資格被提交為下一個分片鏈區塊。運行 BFT 協議以對所選擇的候選區塊（可能存在多於一個）進行一致，所有 “好” 驗證人優選該輪具有最高優先順序的候選區塊。作為運行該協議的結果，通過至少三個驗證人（通過質押）的簽名來增強該區塊。這些簽名不僅證明了所討論的塊的有效性， 而且證明了它是由 BFT 協議選出的。之後，區塊（沒有校對的資料）與這些簽名組合，以確定的方式序列化，並通過網路傳播給所有相關方。

### 2.6.13	驗證人必須保留它們簽名過的區塊。

在它們加入任務組及其後至少一個小時（或者更確切地說是 210個塊）期間，驗證人應該保留它們已簽署和提交的塊。未能向其他驗證人提供簽名區塊可能會受到懲罰。

### 2.6.14	將新分片鏈區塊的塊頭和簽名傳播到所有驗證人。

驗證人使用類似於為每個任務組創建的組播網狀網路，將新生成的分片鏈區塊的區塊頭和簽名傳播到全域驗證人集。

### 2.6.15	主鏈生成新的區塊。

在生成所有（或幾乎所有）新的分片鏈區塊之後，可以生成新的主鏈區塊。該過程與分片鏈區塊（參見 2.6.12）基本相同，不同之處在於所有驗證人（或至少三分之二）都必須參與此過程。因為新的分片鏈區塊的區塊頭和簽名被傳播至所有驗證人，所以每個分片鏈中最新區塊的雜湊可以且必須包含在新的主鏈區塊中。一旦這些雜湊值被提交到主鏈區塊中，外部觀察者和其他分片鏈可能會認為新的分片鏈區塊已提交且不可變（參見 2.1.13）。

### 2.6.16	驗證人必須同步主鏈的狀態。

主鏈和分片鏈之間一個值得注意的區別是，所有驗證人都需要追蹤主鏈狀態，而不依賴于校對資料。這很重要，因為驗證人任務組的知識來自主鏈狀態。

### 2.6.17	分片鏈的區塊是並行生成和傳播的。

通常，每個驗證人都是幾個分片鏈任務組的成員；它們的數量（因此驗證人的負載）大約與驗證人的抵押總比成比例。這意味著驗證人並行運行新的分片鏈區塊生成協定的幾個實例。

### 2.6.18	區塊保留攻擊的緩解。

因為驗證人的總集合在僅看到其標題和簽名之後將新分片鏈區塊的雜湊值插入主鏈中，所以生成該區塊的驗證人很可能會合謀並試圖避免完整地發佈新區塊。這將導致相鄰分片鏈的驗證人無法創建新區塊，因為一旦將其雜湊值提交到主鏈中，它們必須至少知道新區塊的輸出訊息佇列。

---

22 A可能的例外是相鄰分片鏈的輸出佇列的狀態，需要保證2.4.21中描述的消息排序要求，因為在這種情況下Merkle樣張的大小可能變得過高。

---

為了緩解這種情況，新區塊必須收集來自其他驗證人的簽名（例如，相鄰分片鏈的任務組加起來的三分之二），證明這些驗證人確實具有該區塊的副本並且願意將它們發送給其他其他驗證人。只有在這些簽名出現後，新區塊的雜湊才能包含在主鏈中。

### 2.6.19	主鏈區塊比分片鏈區塊生成更晚。

主鏈區塊大約每五秒生成一次，分片鏈區塊也是如此。 然而，雖然所有分片鏈中的新區塊生成基本上同時（通常由新的主鏈區塊的釋放觸發），但是故意延遲生成新的主鏈區塊是為了允許包含主鏈中新生成的分片鏈區塊新的雜湊值。

### 2.6.20	慢的驗證人可能收到較低的獎勵。

如果驗證人動作“慢”，則可能無法驗證新的候選區塊，並且可以在沒有其參與的情況下收集提交新塊所需的簽名的三分之二。 在這種情況下，它將獲得與此塊相關的獎勵的較低份額。這為驗證人提供了優化其硬體、軟體和網路連接的激勵，以便盡可能快地處理使用者交易。

但是，如果驗證人在提交之前未能對塊進行簽名，則其簽名可能包含在下一個區塊之一中，然後包含在部分獎勵中（指數級遞減，具體取決於自生成以來已生成的塊數，例如，如果驗證人延遲了k區塊，那麼就是0.9k ）則仍將給予該驗證人。

### 2.6.21	“深度（Depth）”。

通常，當驗證人對區塊進行簽名時，簽名僅證明區塊的相對有效性：如果該區塊和其他分片鏈中所有的先前區塊都有效，則該區塊有效。 驗證人不能因為將先前區塊中提交的無效資料視為理所當然而受到懲罰。

但是，區塊的驗人者簽名具有稱為 “深度” 的整數參數。 如果它不為零，則意味著驗證人也斷言指定數量的先前區塊的（相對）有效性。 這是 “慢” 或 “暫時離線（temporarily offline）”的驗證人捕獲並簽署一些未經簽名提交的區塊的方法。 他們仍然會獲得一些獎勵（參見 2.6.20
）。

### 2.6.22	驗證人負責簽名的分片鏈區塊的相對有效性；絕對有效性如下。

我們想再次強調，在分片鏈區塊 B 上的驗證人簽名僅證明該區塊的相對有效性（或者如果簽名具有 “Depth”d，則可能也是 d 先前塊的相對有效性，參見 2.6.21；但這並不會影響以下的討論。換句話說，驗證人斷言通過應用 2.2.6 中描述的塊評估函數 ev_block 從先前狀態 s 獲得分片鏈的下一狀態 ：

$s’ = ev\_block(B)(s)$   (24)

以這種方式，如果原始狀態 s 證明為 “錯誤（incorrect）”（例如，由於先前區塊中有一個無效），則不能懲罰簽名塊區 B 的驗證人。漁夫（參見 2.6.4）只有在發現相對無效的區塊時才應該投訴。 PoS 系統作為一個整體努力使每個區塊相對有效，而不是遞迴（或絕對）有效。但是請注意，如果區塊鏈中的所有區塊都相對有效，那麼所有區塊和整個區塊鏈都是絕對有效的；使用區塊鏈長度的數學歸納可以很容易地顯示這個陳述。通過這種方式，對於區塊相對有效性的斷言驗證共同證明了整個區塊鏈的絕對有效性。

注意，通過對區塊 B 進行簽名，驗證人在給定原始狀態 s 的情況下斷言該區塊是有效的（即
，（24）的結果不是指示不能計算下一狀態的值⊥）。以這種方式，驗證人必須對在（24） 的評估期間訪問的原始狀態細胞執行最小的正式檢查。

例如，假設預期包含從提交到區塊中交易訪問帳戶的原始餘額的cell原來具有零個原始位元組， 而不是預期的 8 或 16。 然後原始餘額根本無法從cell取回，並在嘗試處理區塊時發生 “未處理的異常（unhandled exception）”。在這種情況下，驗證人不應該在遭受到懲罰時簽署這樣的區塊。

### 2.6.23	簽名主鏈的區塊

主鏈區塊的情況有所不同：通過簽署主鏈區塊，驗證人不僅斷言其相對有效性，還斷言所有先前區塊的相對有效性，直到該驗證人承擔其責任時的第一個區塊（但不再向後）。

### 2.6.24	驗證人的總量

在目前為止所描述的系統中，要選擇的驗證人總數的上限 T（參見 2.6.7）不能超過，比如幾百或一千，因為所有驗證人都應該參與 BFT 共識協議用於創建每個新的主鏈區塊，並且不清楚這些協議是否可以擴展到數千個參與者。更重要的是，主鏈區塊必須（通過質押）收集所有驗證人中至少三分之二的簽名，並且這些簽名必須包含在新區塊中（否則，系統中的所有其他節點都沒有理由在自己沒有驗證新區塊時信任它。如果超過，例如，每個主鏈區塊中必須包含1000個驗證人簽名，這將意味著每個主鏈區塊中的更多資料，由所有完整節點存儲並通過網路傳播，並且花費更多的處理能力來檢查這些簽名（在 PoS 系統中，完整節點不需要自己驗證區塊，但是它們需要檢查驗證人的簽名）。

雖然限制 T 到1000個驗證人似乎對 TON 區塊鏈的部署的第一階段來說已經足夠，但是當分片鏈總數變得大到幾百個驗證人不足以處理時，必須為未來的增長做出規定。他們都是。為此
，我們引入了一個額外的可配置參數 $T'≤T$（最初等於 $T$），並且只有頂部 $T'$ 選舉的驗證人
（通過質押）才能創建和簽署新的主鏈區塊。

### 2.6.25	去中心化的系統。

人們可能懷疑 TON區塊鏈證明系統依賴於 $T≈1000$ 驗證人來創建所有分片鏈和主鏈區塊，與傳統的工作量證明區塊鏈相比，必然會變得 “過於中心化”。比如比特幣或乙太坊，每個人（原則上）都可以挖掘一個新區塊，而沒有明確的礦工總數上限。

然而，POW 如比特幣和乙太坊，目前需要大量的算力[高 “雜湊率（hash rates）”]來挖掘新區塊，並且概率很低。因此，出塊往往集中某幾個人手中，他們投入大量資金建立研發中心，這些研發中心充滿了針對挖礦優化的定制設計硬體；算力掌握在幾個大型採礦池的手中，這些採礦池集中並協調那些無法自己提供足夠 “算力” 的人而接入網路。

因此，截至 2017 年，超過 75％的新的乙太坊或比特幣區塊由不到 10 名礦工生產。事實上， 兩個最大的 乙太坊 礦池共同產生了超過一半的新區塊！顯然，這樣的系統比依賴於 T≈1000 個節點來生成新區塊的系統更加中心化。

人們可能還會注意到成為 TON區塊鏈驗證人所需的投資——即購買硬體（例如，幾個高性能伺服器）和質押資產（如果需要，可以通過一系列提名人輕鬆收集；參照 2.6.3）——比成為一個成功的比特幣或乙太坊個人礦工所需的付出低得多。實際上，2.6.7 的參數 L 將迫使提名

人不加入最大的 “礦池”（即，已經積累了最大質押資產的驗證人），而是尋找目前接受來自提名人資金的較小驗證人，或者甚至創建新的驗證人，因為這將允許驗證人更高比例的 s'i / si——並且還可以使用提名人的質押資產，因此從挖礦中獲得更大的獎勵。通過這種方式， TON 的 POS 實際上鼓勵分散（創建和使用更多驗證人）並懲罰中心化。

### 2.6.26	區塊的相對可靠性。

區塊的（相對）可靠性取決於已對該區塊簽名的所有驗證人的總質押資產。換句話說，如果這個區塊被證明無效，這那某些參與者就會失去部分質押資產。如果關注轉移價值低於區塊可靠性的交易，可以認為它們足夠安全。從這個意義上講，相對可靠性是外部觀察者在特定區塊中可以擁有的信任度量。

請注意，我們說的是區塊的相對可靠性，因為它保證區塊是有效的，前提是區塊和所有其它所指的分片鏈區塊都有效（參見 2.6.22）。

區塊的相對可靠性在提交後可以增長——例如，當添加了遲來的驗證人簽名時（參見 2.6.21
）。另一方面，如果這些驗證人中的一個由於其與其他區塊有關的不當行為而失去部分或全部
質押資產，則區塊的相對可靠性會降低。

### 2.6.27	“強化（Strengthening）” 區塊鏈

為驗證人提供激勵很重要，它可以盡可能地提高區塊的相對可靠性。 實現此目的的一種方法是向驗證人分配一小筆獎勵，以便將簽名添加到其他分片鏈的區塊中。 即使是 “將來可能（ would-be）” 的有效者，他們已經存入的質押資產不足以通過質押進入最高的 T 驗證人並被納入全域驗證人（參見 2.6.7），也可能參加這項活動（如果他們同意保留他們的質押資產而不是在失去選舉後退出它。 這些潛在的驗證人可能同時成為漁夫（參見 2.6.4）：如果他們不得不檢查某些區塊的有效性，他們也可以選擇報告無效區塊並收集相關的獎勵。

### 2.6.28	區塊的遞迴可靠性。

還可以將區塊的遞迴可靠性定義為其相對可靠性的最小值以及它所引用的所有區塊的遞迴可靠性（例如主鏈區塊、先前的分片區鏈和相鄰的分片鏈的一些區塊）。換句話說，如果該區塊被證明是無效的，或者因為它本身無效或者因為它所依賴的區塊之一是無效的，那麼至少這個數量的錢將被某人丟失。如果真的不確定是否信任區塊中的特定交易，則應該計算該區塊的遞迴可靠性，而不僅僅是相對區塊的遞迴可靠性。

在計算遞迴可靠性時走得太遠是沒有意義的，因為如果我們看得太遠，我們將看到由驗證人簽名的塊，其質押資產已經解凍並撤回。在任何情況下，我們都不允許驗證人自動重新考慮那些舊的區塊（即如果使用了當前的可配置參數值，則在兩個月前創建），並創建從它們開始的分叉或使用輔助設備糾正它們 “垂直區塊鏈（vertical blockchains）”（參見 2.1.17），即使它們結果無效。我們假設兩個月的時間段為檢測和報告任何無效區塊提供了充足的機會，因此如果在此期間沒有對區塊進行質詢，則根本不可能受到質疑。

### 2.6.29	POS 的結果。

TON區塊鏈使用的權益證明方法的一個重要結果是，TON 區塊鏈的輕節點（運行輕節點的用戶端）不需要下載所有分片鏈甚至主鏈區塊的 “頭（headers）”，以便能夠自行檢查由完整節點提供給它的 Merkle 證明的有效性作為其查詢的答案。

實際上，因為最新的分片鏈區塊雜湊包含在主鏈區塊中，所以完整節點可以很輕鬆地提供Merkle 證明，即給定的分片鏈區塊從主鏈區塊的已知雜湊開始有效。接下來，工作中的節點只需要知道主鏈的第一個區塊（其中第一組驗證人被公佈），其中（或至少其中的雜湊）可以內置到用戶端軟體中，並且僅大約每個月發生一個主鏈區塊，其中宣佈新選出的驗證人集，因為該塊將由前一組驗證人簽名。從那開始，它可以獲得幾個最新的主鏈區塊，或者至少它們的區塊頭和驗證人簽名，並使用它們作為檢查由完整節點提供的 Merkle 證明的基礎。